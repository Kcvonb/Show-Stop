event = {'name': 'Dying Wish, Boundaries, Foreign Hands, Roman Candle', 'type': 'event', 'id': 'rZ7HnEZ1AKoxGF', 'test': False, 'url': 'https://www.ticketweb.com/event/dying-wish-boundaries-foreign-hands-neck-of-the-woods-tickets/13462308', 'locale': 'en-us', 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_SOURCE', 'width': 2426, 'height': 1820, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}], 'sales': {'public': {'startDateTime': '2023-08-04T17:00:00Z', 'startTBD': False, 'startTBA': False, 'endDateTime': '2023-12-01T01:30:00Z'}}, 'dates': {'access': {'startDateTime': '2023-12-01T02:30:00Z', 'startApproximate': False, 'endApproximate': False}, 'start': {'localDate': '2023-11-30', 'localTime': '18:30:00', 'dateTime': '2023-12-01T02:30:00Z', 'dateTBD': False, 'dateTBA': False, 'timeTBA': False, 'noSpecificTime': False}, 'end': {'approximate': False, 'noSpecificTime': False}, 'timezone': 'America/Los_Angeles', 'status': {'code': 'offsale'}, 'spanMultipleDays': False}, 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAeA', 'name': 'Rock'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}, {'primary': False, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAvt', 'name': 'Metal'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vk6E', 'name': 'Metal'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}, {'primary': False, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAvt', 'name': 'Metal'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vk6E', 'name': 'Metal'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}, {'primary': False, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAva', 'name': 'Folk'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7vAn7', 'name': 'Folk'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'info': 'The Hard Times presentsThursday November 30, 2023DYING WISHBOUNDARIESFOREIGN HANDSROMAN CANDLE@ NECK OF THE WOODS406 Clement st. San Francisco, CA 94118Show: 7:30Doors: 6:30All Ages$20 in adv$25 at doors', '_links': {'self': {'href': '/discovery/v2/events/rZ7HnEZ1AKoxGF?locale=en-us'}, 'attractions': [{'href': '/discovery/v2/attractions/K8vZ917_kB0?locale=en-us'}, {'href': '/discovery/v2/attractions/K8vZ9172qYf?locale=en-us'}], 'venues': [{'href': '/discovery/v2/venues/rZ7HnEZ17f-ug?locale=en-us'}]}, '_embedded': {'venues': [{'name': 'Neck of the Woods', 'type': 'venue', 'id': 'rZ7HnEZ17f-ug', 'test': False, 'url': 'https://www.ticketweb.com/venue/neck-of-the-woods-san-francisco-ca/521375', 'locale': 'en-us', 'postalCode': '94118', 'timezone': 'America/Los_Angeles', 'city': {'name': 'San Francisco'}, 'state': {'name': 'California', 'stateCode': 'CA'}, 'country': {'name': 'United States Of America', 'countryCode': 'US'}, 'address': {'line1': '406 Clement St'}, 'location': {'longitude': '-122.463783', 'latitude': '37.78323'}, 'upcomingEvents': {'ticketweb': 7, '_total': 7, '_filtered': 0}, '_links': {'self': {'href': '/discovery/v2/venues/rZ7HnEZ17f-ug?locale=en-us'}}}], 'attractions': [{'name': 'Dying Wish', 'type': 'attraction', 'id': 'K8vZ917_kB0', 'test': False, 'url': 'https://www.ticketmaster.com/dying-wish-tickets/artist/2770557', 'locale': 'en-us', 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_SOURCE', 'width': 2426, 'height': 1820, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': False}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': False}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': False}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/a/916/d248b787-c472-4f90-8a6c-d5f03d499916_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': False}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAeA', 'name': 'Rock'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7v6kl', 'name': 'Hard Rock'}, 'type': {'id': 'KZAyXgnZfZ7v7l1', 'name': 'Group'}, 'subType': {'id': 'KZFzBErXgnZfZ7vA76', 'name': 'Group'}, 'family': False}], 'upcomingEvents': {'moshtix': 1, 'ticketmaster': 5, 'ticketweb': 2, '_total': 8, '_filtered': 0}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ917_kB0?locale=en-us'}}}, {'name': 'Boundaries', 'type': 'attraction', 'id': 'K8vZ9172qYf', 'test': False, 'url': 'https://www.ticketmaster.com/boundaries-tickets/artist/1696291', 'locale': 'en-us', 'externalLinks': {'youtube': [{'url': 'https://www.youtube.com/channel/UCErdTWoPIJInPxyCwZQJaJg'}], 'itunes': [{'url': 'https://music.apple.com/ca/artist/boundaries/594698258'}], 'facebook': [{'url': 'https://www.facebook.com/BoundariesCT/'}], 'spotify': [{'url': 'https://open.spotify.com/artist/7a29ko2je7GUMrbmwn4t3I?autoplay=true'}], 'instagram': [{'url': 'https://www.instagram.com/boundariesct/'}]}, 'images': [{'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_RETINA_PORTRAIT_16_9.jpg', 'width': 640, 'height': 360, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_TABLET_LANDSCAPE_LARGE_16_9.jpg', 'width': 2048, 'height': 1152, 'fallback': True}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_ARTIST_PAGE_3_2.jpg', 'width': 305, 'height': 203, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_RECOMENDATION_16_9.jpg', 'width': 100, 'height': 56, 'fallback': True}, {'ratio': '4_3', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_CUSTOM.jpg', 'width': 305, 'height': 225, 'fallback': True}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_TABLET_LANDSCAPE_3_2.jpg', 'width': 1024, 'height': 683, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_TABLET_LANDSCAPE_16_9.jpg', 'width': 1024, 'height': 576, 'fallback': True}, {'ratio': '3_2', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_RETINA_PORTRAIT_3_2.jpg', 'width': 640, 'height': 427, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_EVENT_DETAIL_PAGE_16_9.jpg', 'width': 205, 'height': 115, 'fallback': True}, {'ratio': '16_9', 'url': 'https://s1.ticketm.net/dam/c/fbc/b293c0ad-c904-4215-bc59-8d7f2414dfbc_106141_RETINA_LANDSCAPE_16_9.jpg', 'width': 1136, 'height': 639, 'fallback': True}], 'classifications': [{'primary': True, 'segment': {'id': 'KZFzniwnSyZfZ7v7nJ', 'name': 'Music'}, 'genre': {'id': 'KnvZfZ7vAeA', 'name': 'Rock'}, 'subGenre': {'id': 'KZazBEonSMnZfZ7v6dt', 'name': 'Alternative Rock'}, 'type': {'id': 'KZAyXgnZfZ7v7nI', 'name': 'Undefined'}, 'subType': {'id': 'KZFzBErXgnZfZ7v7lJ', 'name': 'Undefined'}, 'family': False}], 'upcomingEvents': {'ticketweb': 1, 'ticketmaster': 2, '_total': 3, '_filtered': 0}, '_links': {'self': {'href': '/discovery/v2/attractions/K8vZ9172qYf?locale=en-us'}}}]}}

# for element in event.keys():
#     print(element)
#     # print(event[element])

# print(event['dates']['access']['startDateTime'])

# for elem in event['dates'].keys():
#     print(elem)

import os
import requests
import datetime

genre="metal"

htmldate= '2023-08-20'
dateobj=datetime.datetime.strptime(htmldate,'%Y-%m-%d') 

dateobj.isoformat()
isostring=dateobj.isoformat() + 'Z'

payload={'apikey': os.environ['TICKETMASTER_KEY'], 'city': 'San Francisco', 'keyword': 'music', 'classificationName': genre, 'startEndDateTime' : '2023-08-20T14:00:00Z, 2023-08-30T14:00:00Z'}
res = requests.get("https://app.ticketmaster.com/discovery/v2/events.json", params=payload)
data = res.json()

# htmldate= '2023-08-20'
# dateobj=datetime.datetime.strptime(htmldate,'%Y-%m-%d')

# dateobj.isoformat()
# isostring=dateobj.isoformat() + 'Z'
#2020-07-08T14:00:00Z 

#valid ISO 8601
#https://docs.python.org/3/library/datetime.html#strftime-and-strptime-behavior


events = data['_embedded']['events']


for event in events:
    print(event['name'])
    # print("     ", event.get("dates", "***'dates' not a key"))
    event_dates = event.get("dates", [])
    event.get("dates").get("start").get('localDate')
    print("         date ==", event_dates["start"]['localDate'])
    print("         time ==", event_dates["start"].get('localTime'), "no time found for some reason")
    event_classifications = event.get("classifications", [])

# [{'code': 'DIS1067', 'detail': 'Query param: startEndDateTime - Date must be of valid ISO 8601 date and time format {example: 2020-08-01T14:00:00Z}', 'status': '400', '_links': {'self': {'href': '/discovery/v2/errors.html#DIS1067'}}}, {'code': 'DIS1068', 'detail': 'Query param: startEndDateTime - Range must be of a valid format.  use * to designate an unbounded value. {example: range less then *,2023-08-12T14:00:00Z greater: 2023-08-12T14:00:00Z,* between: 2023-08-20T14:00:00Z,2023-08-30T14:00:00Z}', 'status': '400', '_links': {'self': {'href': '/discovery/v2/errors.html#DIS1068'}}}]


